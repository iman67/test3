# Python package
# Create and test a Python package on multiple Python versions.
# Add steps that analyze code, save the dist with the build record, publish to a PyPI-compatible index, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/python

trigger:
- master

pool:
  vmImage: 'ubuntu-latest'
stages:
- stage: Build
  jobs:
  - job: Build
    continueOnError: true
    steps:
    - script: echo 'Hi'

    - task: PowerShell@2
      inputs:
        targetType: 'inline'
        script: |
          # Write your PowerShell commands here.

          Write-Host "##vso[task.setvariable variable=Key;]true"

    - task: CmdLine@2
      inputs:
        script: echo Key:'$(Key)'
    - task: Bash@3
      inputs:
       targetType: 'inline'
       script: |
         echo "##vso[task.setvariable variable=AppType;]WebJob"
         echo "##[debug] AppType set to WebJob"

# This works, using the task condition
    - task: 
      condition: eq(variables['AppType'], 'WebJob')
      displayName: 'net publish for WebJob'
      

    # This doesn't work, using the conditional insertion, index syntax
      ${{ if eq(variables['AppType'], 'WebJob') }}:
    - task: 
      displayName: 'net publish for WebJob'
      inputs:
        command: 'publish'

    # This also doesn't work, using the conditional insertion, property dereference syntax
      ${{ if eq(variables.AppType, 'WebJob') }}:
    - task: DotNetCoreCLI@2
      displayName: 'net publish for WebJob'
      inputs:
          command: 'publish'
